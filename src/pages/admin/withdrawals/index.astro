---
import AdminLayout from "../../../layouts/AdminLayout.astro";

const pageTitle = "Withdrawal Requests - Admin";

// Mock withdrawal data
const withdrawals = [
    {
        id: "WD001",
        user: "john_doe",
        email: "john@mail.com",
        amount: 100000,
        bank: "BCA",
        account: "1234567890",
        accountName: "John Doe",
        status: "pending",
        date: "01/02/2026 11:30",
    },
    {
        id: "WD002",
        user: "jane_smith",
        email: "jane@mail.com",
        amount: 250000,
        bank: "DANA",
        account: "081234567890",
        accountName: "Jane Smith",
        status: "processing",
        date: "01/02/2026 08:00",
    },
    {
        id: "WD003",
        user: "budi_k",
        email: "budi@mail.com",
        amount: 500000,
        bank: "Mandiri",
        account: "0987654321",
        accountName: "Budi Kusuma",
        status: "completed",
        date: "31/01/2026 16:45",
    },
    {
        id: "WD004",
        user: "siti_n",
        email: "siti@mail.com",
        amount: 75000,
        bank: "Gopay",
        account: "081987654321",
        accountName: "Siti Nurhaliza",
        status: "rejected",
        date: "31/01/2026 12:20",
    },
];

const statusColors: Record<string, string> = {
    pending: "bg-yellow-500/20 text-yellow-400 border-yellow-500/30",
    processing: "bg-blue-500/20 text-blue-400 border-blue-500/30",
    completed: "bg-emerald-500/20 text-emerald-400 border-emerald-500/30",
    rejected: "bg-red-500/20 text-red-400 border-red-500/30",
};
---

<AdminLayout title={pageTitle}>
    <!-- Header -->
    <div
        class="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4"
    >
        <div>
            <h1 class="text-2xl font-bold text-white tracking-tight">
                Withdrawal Requests
            </h1>
            <p class="text-gray-400 text-sm mt-1">
                Kelola semua permintaan penarikan dana
            </p>
        </div>
    </div>

    <!-- Filters & Search -->
    <div
        class="bg-[#142925] rounded-[2rem] p-6 border border-[#1F3D36] mb-8 shadow-sm"
    >
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <!-- Search -->
            <div class="md:col-span-2 relative">
                <div
                    class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                >
                    <svg
                        class="w-5 h-5"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                        ><path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                        ></path></svg
                    >
                </div>
                <input
                    type="text"
                    placeholder="Cari ID Withdrawal atau Nama User..."
                    class="w-full pl-12 pr-4 py-3 bg-[#0C1A18] border border-[#1F3D36] rounded-xl text-white placeholder-gray-500 text-sm focus:outline-none focus:ring-2 focus:ring-[#D4F24F]/50 focus:border-[#D4F24F] transition-all"
                />
            </div>

            <!-- Filters -->
            <select
                class="px-4 py-3 bg-[#0C1A18] border border-[#1F3D36] rounded-xl text-white text-sm outline-none focus:ring-2 focus:ring-[#D4F24F]/50 focus:border-[#D4F24F] transition-all cursor-pointer"
            >
                <option value="">Semua Status</option>
                <option value="pending">Pending</option>
                <option value="processing">Processing</option>
                <option value="completed">Completed</option>
                <option value="rejected">Rejected</option>
            </select>
            <select
                class="px-4 py-3 bg-[#0C1A18] border border-[#1F3D36] rounded-xl text-white text-sm outline-none focus:ring-2 focus:ring-[#D4F24F]/50 focus:border-[#D4F24F] transition-all cursor-pointer"
            >
                <option value="">Semua Bank</option>
                <option value="bca">BCA</option>
                <option value="mandiri">Mandiri</option>
                <option value="dana">DANA</option>
                <option value="gopay">Gopay</option>
            </select>
        </div>
    </div>

    <!-- Stats Cards -->

    <!-- Withdrawals Table -->
    <div
        class="bg-[#142925] rounded-[2rem] border border-[#1F3D36] overflow-hidden shadow-sm"
    >
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-[#1F3D36] bg-[#0C1A18]/50">
                        <th
                            class="text-left px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >ID</th
                        >
                        <th
                            class="text-left px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >User</th
                        >
                        <th
                            class="text-left px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >Amount</th
                        >
                        <th
                            class="text-left px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >Bank/E-Wallet</th
                        >
                        <th
                            class="text-left px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >Account</th
                        >
                        <th
                            class="text-left px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >Status</th
                        >
                        <th
                            class="text-left px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >Date</th
                        >
                        <th
                            class="text-center px-6 py-4 text-xs font-bold text-gray-400 uppercase tracking-wider"
                            >Actions</th
                        >
                    </tr>
                </thead>
                <tbody class="divide-y divide-[#1F3D36]">
                    {
                        withdrawals.map((wd) => (
                            <tr class="group hover:bg-[#1F3D36]/30 transition-colors">
                                <td class="px-6 py-4">
                                    <span class="text-white font-mono text-sm">
                                        {wd.id}
                                    </span>
                                </td>
                                <td class="px-6 py-4">
                                    <div>
                                        <p class="text-white font-bold text-sm">
                                            {wd.user}
                                        </p>
                                        <p class="text-gray-500 text-xs">
                                            {wd.email}
                                        </p>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <span class="text-red-400 font-bold">
                                        - Rp {wd.amount.toLocaleString("id-ID")}
                                    </span>
                                </td>
                                <td class="px-6 py-4">
                                    <span class="text-gray-300 text-sm font-medium">
                                        {wd.bank}
                                    </span>
                                </td>
                                <td class="px-6 py-4">
                                    <div>
                                        <p class="text-white text-sm font-mono">
                                            {wd.account}
                                        </p>
                                        <p class="text-gray-500 text-xs">
                                            {wd.accountName}
                                        </p>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <span
                                        class={`px-3 py-1 text-xs font-bold rounded-full border ${statusColors[wd.status]}`}
                                    >
                                        {wd.status.charAt(0).toUpperCase() +
                                            wd.status.slice(1)}
                                    </span>
                                </td>
                                <td class="px-6 py-4">
                                    <span class="text-gray-400 text-sm">
                                        {wd.date}
                                    </span>
                                </td>
                                <td class="px-6 py-4 text-center">
                                    <button class="text-gray-400 hover:text-white transition-colors bg-[#0C1A18] hover:bg-[#1F3D36] p-1.5 rounded-lg border border-[#1F3D36]">
                                        <svg
                                            class="w-4 h-4"
                                            fill="none"
                                            stroke="currentColor"
                                            viewBox="0 0 24 24"
                                        >
                                            <>
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                                                />
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                                                />
                                            </>
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        ))
                    }
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div
            class="px-6 py-4 border-t border-[#1F3D36] flex items-center justify-between bg-[#0C1A18]/30"
        >
            <span class="text-xs font-bold text-gray-500"
                >Showing 1 to 4 of 4 entries</span
            >
            <div class="flex gap-2">
                <button
                    disabled
                    class="px-3 py-1.5 rounded-lg border border-[#1F3D36] text-gray-600 font-bold text-xs cursor-not-allowed"
                    >Prev</button
                >
                <button
                    class="px-3 py-1.5 rounded-lg bg-[#D4F24F] text-[#0C1A18] font-bold text-xs hover:bg-[#c3e33b] transition-all"
                    >1</button
                >
                <button
                    class="px-3 py-1.5 rounded-lg border border-[#1F3D36] text-gray-400 hover:text-white hover:bg-[#1F3D36] font-bold text-xs transition-all"
                    >Next</button
                >
            </div>
        </div>
    </div>
</AdminLayout>

<script is:inline>
    function processWithdrawal(id) {
        if (confirm(`Mark withdrawal ${id} as Processing?`)) {
            alert(`Withdrawal ${id} is now Processing! (Simulated)`);
        }
    }

    function completeWithdrawal(id) {
        if (confirm(`Mark withdrawal ${id} as Completed?`)) {
            alert(`Withdrawal ${id} has been Completed! (Simulated)`);
        }
    }

    function rejectWithdrawal(id) {
        const reason = prompt(
            `Reject withdrawal ${id}? Funds will be refunded. Enter reason:`,
        );
        if (reason !== null) {
            alert(
                `Withdrawal ${id} rejected. Funds refunded. Reason: ${reason || "No reason"} (Simulated)`,
            );
        }
    }
</script>

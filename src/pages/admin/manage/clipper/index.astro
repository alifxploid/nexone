---
import AdminLayout from "../../../../layouts/AdminLayout.astro";

const pageTitle = "Kelola Clipper - Admin";

// Platform Settings
const platformSettings = {
    platformFeePercent: 30,
    publisherSharePercent: 70,
    minRatePer1kViews: 5000,
    maxRatePer1kViews: 50000,
    reviewPeriod: 7, // days
};

// Stats Overview (Mock)
const stats = {
    totalCampaigns: 45,
    activeCampaigns: 12,
    totalPublishers: 234,
    totalViewsMonth: 2500000,
    totalEarningsMonth: 18500000,
    platformRevenueMonth: 5550000, // 30% of total
};
---

<AdminLayout title={pageTitle}>
    <!-- Header -->
    <div
        class="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4"
    >
        <div>
            <h1 class="text-2xl font-bold text-white tracking-tight">
                Kelola Clipper
            </h1>
            <p class="text-gray-400 text-sm mt-1">
                Atur fee platform dan batasan rate untuk layanan Clipper.
            </p>
        </div>
        <button
            class="flex items-center gap-2 px-5 py-2.5 bg-[#D4F24F] hover:bg-[#c3e33b] text-[#0F1F1C] rounded-xl font-bold transition-all shadow-lg hover:-translate-y-0.5 active:scale-95 text-sm"
        >
            <svg
                class="w-4 h-4"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 13l4 4L19 7"></path></svg
            >
            Simpan Perubahan
        </button>
    </div>

    <!-- Stats Overview -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        <div class="bg-[#142925] rounded-2xl p-5 border border-[#1F3D36]">
            <p
                class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1"
            >
                Kampanye Aktif
            </p>
            <p class="text-2xl font-bold text-white">{stats.activeCampaigns}</p>
            <p class="text-gray-500 text-xs">
                dari {stats.totalCampaigns} total
            </p>
        </div>
        <div class="bg-[#142925] rounded-2xl p-5 border border-[#1F3D36]">
            <p
                class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1"
            >
                Total Publisher
            </p>
            <p class="text-2xl font-bold text-white">{stats.totalPublishers}</p>
        </div>
        <div class="bg-[#142925] rounded-2xl p-5 border border-[#1F3D36]">
            <p
                class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1"
            >
                Views Bulan Ini
            </p>
            <p class="text-2xl font-bold text-emerald-400">
                {(stats.totalViewsMonth / 1000000).toFixed(1)}M
            </p>
        </div>
        <div class="bg-[#142925] rounded-2xl p-5 border border-[#1F3D36]">
            <p
                class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1"
            >
                Pendapatan Platform
            </p>
            <p class="text-2xl font-bold text-[#D4F24F]">
                Rp {(stats.platformRevenueMonth / 1000000).toFixed(1)}jt
            </p>
            <p class="text-gray-500 text-xs">fee 30% bulan ini</p>
        </div>
    </div>

    <!-- Main Settings Card -->
    <div
        class="bg-[#142925] rounded-[2rem] p-6 border border-[#1F3D36] mb-8 shadow-sm"
    >
        <h2 class="text-lg font-bold text-white mb-6 flex items-center gap-2">
            <svg
                class="w-5 h-5 text-[#D4F24F]"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                ></path>
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            Pengaturan Fee & Rate
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Fee Platform Section -->
            <div class="space-y-6">
                <h3
                    class="text-sm font-bold text-gray-400 uppercase tracking-wider"
                >
                    Pembagian Hasil
                </h3>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label
                            class="block text-gray-400 text-xs font-bold uppercase tracking-wider mb-2"
                        >
                            Fee Platform
                        </label>
                        <div class="flex items-center gap-2">
                            <input
                                type="number"
                                value={platformSettings.platformFeePercent}
                                class="w-full px-4 py-3 bg-[#0C1A18] border border-amber-500/30 rounded-xl text-amber-400 text-xl font-bold text-center focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"
                            />
                            <span class="text-amber-400 font-bold text-xl"
                                >%</span
                            >
                        </div>
                    </div>
                    <div>
                        <label
                            class="block text-gray-400 text-xs font-bold uppercase tracking-wider mb-2"
                        >
                            Publisher Dapat
                        </label>
                        <div class="flex items-center gap-2">
                            <input
                                type="number"
                                value={platformSettings.publisherSharePercent}
                                class="w-full px-4 py-3 bg-[#0C1A18] border border-emerald-500/30 rounded-xl text-emerald-400 text-xl font-bold text-center focus:outline-none focus:ring-2 focus:ring-emerald-500/50 transition-all"
                            />
                            <span class="text-emerald-400 font-bold text-xl"
                                >%</span
                            >
                        </div>
                    </div>
                </div>

                <!-- Visual Bar -->
                <div
                    class="bg-[#0C1A18] rounded-xl p-4 border border-[#1F3D36]"
                >
                    <div class="flex h-4 rounded-full overflow-hidden">
                        <div
                            class="bg-emerald-500"
                            style={`width: ${platformSettings.publisherSharePercent}%`}
                        >
                        </div>
                        <div
                            class="bg-amber-500"
                            style={`width: ${platformSettings.platformFeePercent}%`}
                        >
                        </div>
                    </div>
                    <div class="flex justify-between mt-2 text-xs font-bold">
                        <span class="text-emerald-400"
                            >Publisher: {
                                platformSettings.publisherSharePercent
                            }%</span
                        >
                        <span class="text-amber-400"
                            >Platform: {
                                platformSettings.platformFeePercent
                            }%</span
                        >
                    </div>
                </div>
            </div>

            <!-- Rate Limits Section -->
            <div class="space-y-6">
                <h3
                    class="text-sm font-bold text-gray-400 uppercase tracking-wider"
                >
                    Batasan Rate Advertiser
                </h3>

                <div>
                    <label
                        class="block text-gray-400 text-xs font-bold uppercase tracking-wider mb-2"
                    >
                        Min. Rate per 1k Views
                    </label>
                    <div class="flex items-center gap-2">
                        <span class="text-gray-400 font-bold">Rp</span>
                        <input
                            type="number"
                            value={platformSettings.minRatePer1kViews}
                            class="flex-1 px-4 py-3 bg-[#0C1A18] border border-[#1F3D36] rounded-xl text-white text-sm focus:outline-none focus:ring-2 focus:ring-[#D4F24F]/50 transition-all font-mono"
                        />
                    </div>
                    <p class="text-gray-600 text-xs mt-1">
                        Batas minimum rate yang bisa diset advertiser
                    </p>
                </div>

                <div>
                    <label
                        class="block text-gray-400 text-xs font-bold uppercase tracking-wider mb-2"
                    >
                        Max. Rate per 1k Views
                    </label>
                    <div class="flex items-center gap-2">
                        <span class="text-gray-400 font-bold">Rp</span>
                        <input
                            type="number"
                            value={platformSettings.maxRatePer1kViews}
                            class="flex-1 px-4 py-3 bg-[#0C1A18] border border-[#1F3D36] rounded-xl text-white text-sm focus:outline-none focus:ring-2 focus:ring-[#D4F24F]/50 transition-all font-mono"
                        />
                    </div>
                    <p class="text-gray-600 text-xs mt-1">
                        Batas maksimum rate yang bisa diset advertiser
                    </p>
                </div>
            </div>
        </div>

        <!-- Additional Settings -->
        <div class="mt-8 pt-6 border-t border-[#1F3D36]">
            <div>
                <label
                    class="block text-gray-400 text-xs font-bold uppercase tracking-wider mb-2"
                >
                    Periode Review Advertiser
                </label>
                <div class="flex items-center gap-2">
                    <input
                        type="number"
                        value={platformSettings.reviewPeriod}
                        class="w-24 px-4 py-3 bg-[#0C1A18] border border-[#1F3D36] rounded-xl text-white text-sm focus:outline-none focus:ring-2 focus:ring-[#D4F24F]/50 transition-all"
                    />
                    <span class="text-gray-400">hari</span>
                </div>
                <p class="text-gray-600 text-xs mt-1">
                    Advertiser wajib cek hasil clip setiap X hari
                </p>
            </div>
        </div>
    </div>

    <!-- Example Calculation -->
    <div
        class="bg-[#142925] rounded-[2rem] p-6 border border-[#1F3D36] shadow-sm"
    >
        <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
            <svg
                class="w-5 h-5 text-[#D4F24F]"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"
                ></path>
            </svg>
            Contoh Perhitungan Pendapatan
        </h3>

        <div class="bg-[#0C1A18] rounded-xl p-5 border border-[#1F3D36] mb-4">
            <p class="text-gray-400 text-sm mb-4">
                Skenario: Advertiser set rate <span class="text-white font-bold"
                    >Rp 10.000 / 1k views</span
                >, publisher dapat 10.000 views
            </p>

            <div class="space-y-3">
                <div
                    class="flex items-center justify-between py-2 border-b border-[#1F3D36]"
                >
                    <span class="text-gray-400"
                        >Rate per 1k views (dari advertiser)</span
                    >
                    <span class="text-white font-mono">Rp 10.000</span>
                </div>
                <div
                    class="flex items-center justify-between py-2 border-b border-[#1F3D36]"
                >
                    <span class="text-gray-400">Total views publisher</span>
                    <span class="text-white font-mono">10.000 views</span>
                </div>
                <div
                    class="flex items-center justify-between py-2 border-b border-[#1F3D36]"
                >
                    <span class="text-gray-400 font-bold">Total Earnings</span>
                    <span class="text-white font-bold font-mono"
                        >Rp 100.000</span
                    >
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div
                class="bg-amber-500/10 rounded-xl p-5 border border-amber-500/30"
            >
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-3 h-3 rounded-full bg-amber-500"></div>
                    <p class="text-amber-400 font-bold">
                        Fee Platform ({platformSettings.platformFeePercent}%)
                    </p>
                </div>
                <p class="text-3xl font-bold text-amber-400 font-mono">
                    Rp 30.000
                </p>
                <p class="text-amber-400/60 text-xs mt-1">
                    Pendapatan platform dari transaksi ini
                </p>
            </div>
            <div
                class="bg-emerald-500/10 rounded-xl p-5 border border-emerald-500/30"
            >
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-3 h-3 rounded-full bg-emerald-500"></div>
                    <p class="text-emerald-400 font-bold">
                        Publisher Dapat ({
                            platformSettings.publisherSharePercent
                        }%)
                    </p>
                </div>
                <p class="text-3xl font-bold text-emerald-400 font-mono">
                    Rp 70.000
                </p>
                <p class="text-emerald-400/60 text-xs mt-1">
                    Yang masuk ke saldo publisher
                </p>
            </div>
        </div>
    </div>

    <!-- Info Note -->
    <div class="mt-6 p-4 bg-[#0C1A18] rounded-xl border border-[#1F3D36]">
        <p class="text-gray-400 text-sm flex items-start gap-2">
            <svg
                class="w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
            </svg>
            <span>
                <strong class="text-white">Catatan:</strong> Advertiser yang menentukan
                rate per 1k views saat membuat kampanye. Admin hanya mengatur fee
                platform dan batasan min/max rate. Review dilakukan manual oleh advertiser
                setiap <strong class="text-white"
                    >{platformSettings.reviewPeriod} hari</strong
                >.
            </span>
        </p>
    </div>
</AdminLayout>

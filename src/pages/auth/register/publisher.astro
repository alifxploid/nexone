---
import Layout from "../../../layouts/Layout.astro";

// TypeScript interface for form data (Astro v5 best practice)
interface PublisherFormData {
    full_name: string;
    username: string;
    phone: string;
    email: string;
    bank_name: string;
    account_number: string;
    password: string;
    confirm_password: string;
    role: "publisher";
}
---

<Layout title="Daftar Publisher - NexOne">
    <div
        class="min-h-screen flex items-center justify-center p-4 md:p-6 bg-gradient-to-br from-gray-50 via-gray-100 to-gray-50 font-sans"
    >
        <div
            class="w-full max-w-[460px] bg-white p-6 md:p-10 rounded-3xl shadow-2xl shadow-gray-200/50 border border-gray-100 transition-all"
        >
            <!-- Logo -->
            <div class="mb-6 flex justify-center">
                <a href="/" class="flex items-center gap-2.5 group">
                    <div
                        class="w-11 h-11 bg-[#ff6b6b] rounded-xl flex items-center justify-center text-white font-bold text-xl group-hover:scale-110 transition-transform shadow-lg shadow-red-200"
                    >
                        N
                    </div>
                    <span
                        class="text-2xl font-bold text-gray-800 tracking-tight"
                        >NexOne</span
                    >
                </a>
            </div>

            <div class="text-center mb-6">
                <h1
                    class="text-2xl font-bold text-gray-800 mb-2 tracking-tight"
                >
                    Daftar Publisher
                </h1>
                <p class="text-gray-500 text-sm">
                    Mulai hasilkan uang dari social media kamu.
                </p>
            </div>

            <!-- Tab Switcher -->
            <div class="flex p-1 bg-gray-100 rounded-xl mb-6">
                <a
                    href="/auth/register/publisher"
                    class="flex-1 py-2.5 text-sm font-bold rounded-lg transition-all shadow-sm text-[#ff6b6b] bg-white ring-1 ring-black/5 text-center"
                >
                    <i class="fa-solid fa-user mr-1.5"></i> Publisher
                </a>
                <a
                    href="/auth/register/advertiser"
                    class="flex-1 py-2.5 text-sm font-bold rounded-lg transition-all text-gray-500 hover:text-[#ff6b6b] text-center"
                >
                    <i class="fa-solid fa-bullhorn mr-1.5"></i> Advertiser
                </a>
            </div>

            <form
                class="space-y-4 text-left"
                action="/auth/verify-email"
                method="POST"
            >
                <input type="hidden" name="role" value="publisher" />

                <!-- Nama Lengkap -->
                <div>
                    <label
                        for="full_name"
                        class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                        >Nama Lengkap</label
                    >
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                        >
                            <i class="fa-solid fa-user"></i>
                        </div>
                        <input
                            id="full_name"
                            name="full_name"
                            type="text"
                            required
                            class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium"
                            placeholder="John Doe"
                        />
                    </div>
                </div>

                <!-- Username -->
                <div>
                    <label
                        for="username"
                        class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                        >Username Publisher</label
                    >
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                        >
                            <i class="fa-solid fa-at"></i>
                        </div>
                        <input
                            id="username"
                            name="username"
                            type="text"
                            required
                            class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium"
                            placeholder="johndoe123"
                        />
                    </div>
                </div>

                <!-- Nomer HP -->
                <div>
                    <label
                        for="phone"
                        class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                        >Nomer HP / WhatsApp</label
                    >
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                        >
                            <i class="fa-solid fa-phone"></i>
                        </div>
                        <input
                            id="phone"
                            name="phone"
                            type="tel"
                            required
                            class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium"
                            placeholder="08123456789"
                        />
                    </div>
                </div>

                <!-- Email -->
                <div>
                    <label
                        for="email"
                        class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                        >Email Address</label
                    >
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                        >
                            <i class="fa-solid fa-envelope"></i>
                        </div>
                        <input
                            id="email"
                            name="email"
                            type="email"
                            required
                            class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium"
                            placeholder="john@example.com"
                        />
                    </div>
                </div>

                <!-- Withdraw Info -->
                <div class="pt-3 border-t border-gray-100">
                    <p
                        class="text-xs font-bold text-[#ff6b6b] uppercase tracking-wider mb-3"
                    >
                        <i class="fa-solid fa-wallet mr-1.5"></i> Info Penarikan
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div>
                            <label
                                for="bank_name"
                                class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                                >Metode</label
                            >
                            <div class="relative">
                                <div
                                    class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                                >
                                    <i class="fa-solid fa-credit-card"></i>
                                </div>
                                <select
                                    id="bank_name"
                                    name="bank_name"
                                    required
                                    class="w-full pl-11 pr-10 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium appearance-none"
                                >
                                    <option value="" disabled selected
                                        >Pilih</option
                                    >
                                    <option value="BRI">Bank BRI</option>
                                    <option value="BCA">Bank BCA</option>
                                    <option value="DANA">DANA</option>
                                </select>
                                <div
                                    class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none text-gray-400"
                                >
                                    <i class="fa-solid fa-chevron-down text-xs"
                                    ></i>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label
                                for="account_number"
                                class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                                >No. Rekening</label
                            >
                            <div class="relative">
                                <div
                                    class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                                >
                                    <i class="fa-solid fa-hashtag"></i>
                                </div>
                                <input
                                    id="account_number"
                                    name="account_number"
                                    type="number"
                                    required
                                    class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium"
                                    placeholder="1234567890"
                                />
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Password -->
                <div>
                    <label
                        for="password"
                        class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                        >Password</label
                    >
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                        >
                            <i class="fa-solid fa-lock"></i>
                        </div>
                        <input
                            id="password"
                            name="password"
                            type="password"
                            required
                            class="w-full pl-11 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium"
                            placeholder="••••••••"
                        />
                        <button
                            type="button"
                            id="toggle-password"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-[#ff6b6b] focus:outline-none transition-colors"
                        >
                            <i id="eye-password" class="fa-solid fa-eye"></i>
                        </button>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div>
                    <label
                        for="confirm_password"
                        class="block text-xs font-bold text-gray-700 mb-1.5 ml-1"
                        >Konfirmasi Password</label
                    >
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400"
                        >
                            <i class="fa-solid fa-lock"></i>
                        </div>
                        <input
                            id="confirm_password"
                            name="confirm_password"
                            type="password"
                            required
                            class="w-full pl-11 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-800 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 focus:border-[#ff6b6b] transition-all font-medium"
                            placeholder="Ulangi password"
                        />
                        <button
                            type="button"
                            id="toggle-confirm"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-[#ff6b6b] focus:outline-none transition-colors"
                        >
                            <i id="eye-confirm" class="fa-solid fa-eye"></i>
                        </button>
                    </div>
                    <p
                        id="password-error"
                        class="text-xs text-red-500 font-bold hidden mt-1"
                    >
                        Password tidak cocok!
                    </p>
                </div>

                <button
                    type="submit"
                    class="w-full py-3.5 bg-[#ff6b6b] text-white rounded-xl font-bold text-base hover:bg-[#ff5252] transition-all shadow-lg shadow-red-200 hover:shadow-xl hover:-translate-y-0.5 active:scale-[0.98] mt-2"
                >
                    <i class="fa-solid fa-user-plus mr-2"></i> Daftar sebagai Publisher
                </button>
            </form>

            <p class="text-xs text-center text-gray-400 leading-relaxed mt-5">
                Dengan mendaftar, kamu menyetujui <a
                    href="#"
                    class="underline hover:text-[#ff6b6b]">Syarat & Ketentuan</a
                > kami.
            </p>

            <div class="text-center mt-5 pt-5 border-t border-gray-100">
                <p class="text-gray-500 font-medium text-sm">
                    Sudah punya akun? <a
                        href="/auth/login"
                        class="text-[#ff6b6b] font-bold hover:underline"
                        >Masuk</a
                    >
                </p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const togglePassword = (
                btnId: string,
                inputId: string,
                iconId: string,
            ) => {
                const btn = document.getElementById(btnId);
                const input = document.getElementById(
                    inputId,
                ) as HTMLInputElement;
                const icon = document.getElementById(iconId);
                btn?.addEventListener("click", () => {
                    if (input.type === "password") {
                        input.type = "text";
                        icon?.classList.remove("fa-eye");
                        icon?.classList.add("fa-eye-slash");
                    } else {
                        input.type = "password";
                        icon?.classList.remove("fa-eye-slash");
                        icon?.classList.add("fa-eye");
                    }
                });
            };
            togglePassword("toggle-password", "password", "eye-password");
            togglePassword("toggle-confirm", "confirm_password", "eye-confirm");

            // Password validation
            const password = document.getElementById(
                "password",
            ) as HTMLInputElement;
            const confirm = document.getElementById(
                "confirm_password",
            ) as HTMLInputElement;
            const error = document.getElementById("password-error");
            confirm?.addEventListener("input", () => {
                if (confirm.value && password.value !== confirm.value) {
                    error?.classList.remove("hidden");
                } else {
                    error?.classList.add("hidden");
                }
            });
        });
    </script>
</Layout>
